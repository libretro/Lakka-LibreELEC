#!/bin/sh

. config/options

$SCRIPTS/install dbus
$SCRIPTS/install glib
$SCRIPTS/install setserial

PKG_DIR=`find $PACKAGES -type d -name $1`

mkdir -p $INSTALL/usr/bin
cp $BUILD/$1*/src/.libs/bluetoothd $INSTALL/usr/bin
cp $BUILD/$1*/tools/.libs/hciattach $INSTALL/usr/bin

if [ $DEVTOOLS = yes ]; then
  cp $BUILD/$1*/tools/.libs/avinfo $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/bccmd $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/ciptool $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/hciconfig $INSTALL/usr/bin
  cp $BUILD/$1*/tools/hcisecfilter $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/hcitool $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/l2ping $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/ppporc $INSTALL/usr/bin
  cp $BUILD/$1*/tools/.libs/sdptool $INSTALL/usr/bin
  cp $BUILD/$1*/test/.libs/hciemu $INSTALL/usr/bin
fi

cp $PKG_DIR/scripts/* $INSTALL/usr/bin

mkdir -p $INSTALL/usr/lib
cp $BUILD/$1*/lib/.libs/libbluetooth.so* $INSTALL/usr/lib

mkdir -p $INSTALL/usr/lib/bluetooth/plugins
cp $BUILD/$1*/plugins/.libs/*.so $INSTALL/usr/lib/bluetooth/plugins

mkdir -p $INSTALL/etc/bluetooth
cp $BUILD/$1*/src/main.conf $INSTALL/etc/bluetooth

mkdir -p $INSTALL/etc/dbus-1/system.d
cp $BUILD/$1*/src/bluetooth.conf $INSTALL/etc/dbus-1/system.d

mkdir -p $INSTALL/etc/udev/rules.d
cp $BUILD/$1*/scripts/bluetooth.rules \
  $INSTALL/etc/udev/rules.d/35_bluetooth.rules
