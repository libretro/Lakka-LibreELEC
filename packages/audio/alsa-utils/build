#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build alsa-lib
[ "$DEVTOOLS" = yes ] && $SCRIPTS/build ncurses

export CPPFLAGS="$CPPFLAGS -I$LIB_PREFIX/include/ncurses"
export LDFLAGS="$LDFLAGS -L$SYSROOT_PREFIX/usr/lib -L$SYSROOT_PREFIX/usr/lib64 -L$LIB_PREFIX/lib"

ALSAMIXER_CONFIG="--disable-alsamixer"
[ "$DEVTOOLS" = yes ] && ALSAMIXER_CONFIG="--enable-alsamixer"

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --localstatedir=/var \
            --disable-dependency-tracking \
            $ALSAMIXER_CONFIG

make -C amixer

if [ "$DEVTOOLS" = yes ]; then
  make -C alsamixer
  make -C aplay
  make -C iecset
fi

exit 0
