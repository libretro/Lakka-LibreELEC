#!/bin/sh

. config/options

if [ "$2" = toolchain ]; then
  rm -rf "$SYSROOT_PREFIX/lib" "$SYSROOT_PREFIX/usr/lib" "$SYSROOT_PREFIX/usr/include"
  $SCRIPTS/install linux-headers
  make -C $BUILD/$1* PREFIX="$SYSROOT_PREFIX" install
  exit 0
fi

    mkdir -p $INSTALL/lib
    cp $BUILD/$1*/lib/ld*-uClibc.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/libc.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/libdl.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/libpthread.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/libm.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/libutil.so.0 $INSTALL/lib
    cp $BUILD/$1*/lib/librt.so.0 $INSTALL/lib

# needed by dbus-glib
    cp $BUILD/$1*/lib/libnsl.so.0 $INSTALL/lib

    [ "$DEBUG" = yes ] && cp $BUILD/$1*/lib/libthread_db.so.1 $INSTALL/lib
    [ "$NETWORK" = yes ] && cp $BUILD/$1*/lib/libcrypt.so.0 $INSTALL/lib
    [ "$NETWORK" = yes ] && cp $BUILD/$1*/lib/libresolv.so.0 $INSTALL/lib

    [ "$DEVTOOLS" = yes ] && \
      mkdir -p $INSTALL/bin && \
      cp $BUILD/$1*/utils/ldd $INSTALL/bin

    [ -n "$TIMEZONE" ] && mkdir -p $INSTALL/etc && echo -n "$TIMEZONE" > $INSTALL/etc/TZ

exit 0
