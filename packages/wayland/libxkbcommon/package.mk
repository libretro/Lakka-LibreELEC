# SPDX-License-Identifier: GPL-2.0-or-later
# Copyright (C) 2009-2016 Stephan Raue (stephan@openelec.tv)
# Copyright (C) 2019-present Team LibreELEC (https://libreelec.tv)

PKG_NAME="libxkbcommon"
PKG_VERSION="0.8.4"
PKG_SHA256="60ddcff932b7fd352752d51a5c4f04f3d0403230a584df9a2e0d5ed87c486c8b"
PKG_LICENSE="MIT"
PKG_SITE="http://xkbcommon.org"
PKG_URL="http://xkbcommon.org/download/${PKG_NAME}-${PKG_VERSION}.tar.xz"
PKG_DEPENDS_TARGET="toolchain xkeyboard-config"
PKG_LONGDESC="xkbcommon is a library to handle keyboard descriptions."

PKG_MESON_OPTS_TARGET="-Denable-docs=false"
if ! [ "${PROJECT}" = "L4T" ]; then

  if [ "${DISPLAYSERVER}" = "x11" ]; then
    PKG_MESON_OPTS_TARGET+=" -Denable-x11=true \
                             -Denable-wayland=false"
  elif [ "${DISPLAYSERVER}" = "weston" ]; then
    PKG_MESON_OPTS_TARGET+=" -Denable-x11=false \
                             -Denable-wayland=true"
  else
    PKG_MESON_OPTS_TARGET+=" -Denable-x11=false \
                             -Denable-wayland=false"
  fi
else
  PKG_MESON_OPTS_TARGET+=" -Denable-x11=false \
                           -Denable-wayland=false"
fi

pre_configure_target() {

if ! [ "${PROJECT}" = "L4T" ]; then
  if [ "${DISPLAYSERVER}" = "x11" ]; then
    TARGET_LDFLAGS="$LDFLAGS -lXau -lxcb"
  fi
fi

}
